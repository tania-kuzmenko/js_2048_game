function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var t=[],n=0,r=!1,a=document.querySelector(".tileContainer"),o=document.getElementById("scoreElement"),i=document.getElementById("start");function s(){for(var n,r,o,i=[],s=0;s<t.length;s++)for(var c=0;c<t[s].length;c++)0===t[s][c]&&i.push([s,c]);var l=function(e){if(Array.isArray(e))return e}(o=i[Math.floor(Math.random()*i.length)])||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,s=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),2!==o.length);i=!0);}catch(e){s=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return o}}(o,2)||function(t,n){if(t){if("string"==typeof t)return e(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,2)}}(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),d=l[0],u=l[1];t[d][u]=.9>Math.random()?2:4,n=t[d][u],(r=document.createElement("div")).classList.add("field-cell","row"+(d+1),"column"+(u+1),"field-cell--"+n),r.innerHTML=n,a.appendChild(r),r.classList.add("merged"),r.addEventListener("animationend",function(){r.classList.remove("merged")})}function c(e){var t;switch(e.key){case"ArrowUp":t=l(1,0);break;case"ArrowDown":t=l(-1,0);break;case"ArrowLeft":t=l(0,-1);break;case"ArrowRight":t=l(0,1)}if(t){s();var n=m();n.gameOver&&f(n.message)}}function l(e,r){var a=!1,s=!1;if(0!==r)for(var c=1===r?3:0,l=1===r?-1:1,m=0;m<4;m++)for(var f=c;f<=3&&1===l||f>=0&&-1===l;){if(0===t[m][f]){f+=l;continue}var v=d(m,f,0,r),g=".row"+(m+1)+".column"+(f+1),h=document.querySelector(g);if(!v.merge||v.merge&&s){s=!1,v.destinationX+=v.merge?l:0,t[m][v.destinationX]=t[m][f],v.destinationX!==f&&(a=!0,t[m][f]=0),u(m,v.destinationX,h,!1),f+=l;continue}s=!0,t[m][v.destinationX]=2*t[m][f],n+=t[m][v.destinationX],o.innerHTML=n,(4===n||8===n)&&(i.classList.remove("start"),i.classList.add("restart"),i.innerHTML="Restart"),a=!0,t[m][f]=0,u(m,v.destinationX,h,v.merge),f+=l}else if(0!==e)for(var y=1===e?3:0,L=1===e?-1:1,w=0;w<4;w++)for(var b=y;b<=3&&1===L||b>=0&&-1===L;){if(0===t[b][w]){b+=L;continue}var M=d(b,w,e,0),S=".row"+(b+1)+".column"+(w+1),p=document.querySelector(S);if(!M.merge||M.merge&&s){s=!1,M.destinationY+=M.merge?L:0,t[M.destinationY][w]=t[b][w],M.destinationY!==b&&(a=!0,t[b][w]=0),u(M.destinationY,w,p,!1),b+=L;continue}s=!0,t[M.destinationY][w]=2*t[b][w],n+=t[M.destinationY][w],o.innerHTML=n,a=!0,t[b][w]=0,u(M.destinationY,w,p,M.merge),b+=L}return a}function d(e,n,r,a){for(var o=e,i=n,s=!1;o<3&&1===r||o>0&&-1===r||i<3&&1===a||i>0&&-1===a;){var c=o+r,l=i+a,d=t[c][l],u=t[e][n];if((0===d||d===u)&&(o=c,i=l,s=d===u),(0===d||d===u)&&(o=c,i=l,s=d===u),0!==d&&d!==u||s)break}return{merge:s,destinationY:o,destinationX:i}}function u(e,n,r,o){if(Array.from(r.classList).forEach(function(e){(e.startsWith("row")||e.startsWith("column"))&&r.classList.remove(e)}),r.classList.add("row"+(e+1),"column"+(n+1)),o){for(var i=a.querySelectorAll(".row"+(e+1)+".column"+(n+1));i.length>1;)a.removeChild(i[0]),i=a.querySelectorAll(".row"+(e+1)+".column"+(n+1));i[0].className="field-cell row"+(e+1)+" column"+(n+1)+" field-cell--"+t[e][n],i[0].innerHTML=t[e][n],i[0].classList.add("merged"),i[0].addEventListener("animationend",function(){r.classList.remove("merged")})}}function m(){for(var e=!1,n=0;n<t.length;n++)for(var a=0;a<t[n].length;a++){if(0===t[n][a]&&(e=!0),2048===t[n][a]&&!r)return{gameOver:!0,message:"You won!"};3!==a&&t[n][a]===t[n][a+1]&&(e=!0),3!==n&&t[n][a]===t[n+1][a]&&(e=!0)}return e?{gameOver:!1,message:""}:{gameOver:!0,message:"Game over!"}}function f(e){"Game over!"===e&&document.querySelector(".message-lose").classList.remove("hidden"),"You won!"===e&&(r=!0,document.querySelector(".message-win").classList.remove("hidden"),document.removeEventListener("keydown",c))}i.addEventListener("click",function(){i.classList.remove("restart"),i.classList.add("start"),i.innerHTML="Start",document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),a.innerHTML="",o.innerHTML=0,t=[],n=0,r=!1,document.addEventListener("keydown",c),function(){for(var e=0;e<4;e++){for(var n=[],r=0;r<4;r++)n.push(0);t.push(n)}}(),s(),s()});var v=0,g=0;document.addEventListener("touchstart",function(e){v=e.touches[0].clientX,g=e.touches[0].clientY}),document.addEventListener("touchend",function(e){var t,n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY,a=n-v,o=r-g;if(Math.abs(a)>Math.abs(o)?Math.abs(a)>50&&(t=a>0?l(0,1):l(0,-1)):Math.abs(o)>50&&(t=o>0?l(-1,0):l(1,0)),t){s();var i=m();i.gameOver&&f(i.message)}});
//# sourceMappingURL=index.b806f89c.js.map
